<?php
if (isset($_GET['ip'])) {
  // Retrieve the IP address from user input
  $ip = $_GET['ip']; // VULNERABILITY: This input is directly used in a shell command, making it prone to OS Command Injection.

  /*
  VULNERABILITY:
  OS Command Injection: The user-supplied input ($ip) is directly passed to the `shell_exec` function,
  allowing an attacker to inject malicious shell commands. For example, supplying
  `127.0.0.1; rm -rf /` as the input could result in arbitrary command execution.
  */
  $output = shell_exec("ping -c 1 $ip");

  // Display the output of the ping command
  echo "<pre>$output</pre>"; // POTENTIAL INFORMATION DISCLOSURE: The output may reveal sensitive system information.
} else {
  // If no IP address is provided, display an instructional message
  echo "Provide an IP to ping using ?ip= in the URL.";
}
?>
