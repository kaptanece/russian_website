<?php
// view_file.php

if (isset($_GET['file'])) {
  // Get the file parameter from the URL
  $file = $_GET['file'];

  // Vulnerable code: directly including the user input into the file path
  $filePath = 'uploads/' . $file; // This is where path traversal can occur

  // Display the file content if it exists
  if (file_exists($filePath)) {
    $content = file_get_contents($filePath);
    echo nl2br(htmlspecialchars($content)); // Secure output
  } else {
    echo "File not found!";
  }
}
?>
