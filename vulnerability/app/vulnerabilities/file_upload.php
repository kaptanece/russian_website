<?php
// File upload directory
$upload_dir = __DIR__ . '/uploads/';

// Ensure the upload directory exists
if (!file_exists($upload_dir)) {
  mkdir($upload_dir, 0777, true);
}

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['file'])) {
  // Get the uploaded file name
  $file_name = basename($_FILES['file']['name']);
  $file_type = strtolower(pathinfo($file_name, PATHINFO_EXTENSION));
  $target_path = $upload_dir . $file_name;

  // Blacklist approach: Block specific file types
  $blacklisted_types = ['php', 'exe', 'js', 'sh'];

  if (in_array($file_type, $blacklisted_types)) {
    echo "<p style='color: red;'>File type '$file_type' is not allowed!</p>";
  } else {
    // Move the uploaded file to the uploads directory
    if (move_uploaded_file($_FILES['file']['tmp_name'], $target_path)) {
      echo "<p style='color: green;'>File uploaded successfully! File Path: <a href='uploads/$file_name'>uploads/$file_name</a></p>";
    } else {
      echo "<p style='color: red;'>File upload failed.</p>";
    }
  }
}
